{% extends "base.html" %}

{% load static %}

{% load crispy_forms_tags %}

{% block content %}

<div class="container">

    <h1>Our Menu</h1>

    <!-- NEED TO AMEND BOOTSTRAP CLASSES WITH IF/ELSE FOR USER TYPE -->

    {% if user.is_authenticated and user.is_superuser %}
    <div>
        <a href="#" class="btn btn-success add-btn" id="addMenuItemButton">
            <i class="fas fa-plus"></i> Add New Menu Item
        </a>
    </div>

    <!-- Form to add menu item, initially hidden by the 'hidden' class -->
    <div class="row">
        <div class="col-12 offset-md-2 col-md-8">
            <form method="POST" id="menuItemForm" class="hidden">
                {{ menu_item_form | crispy }}
                {% csrf_token %}
                <button id="submitButton" type="submit" class="btn btn-signup btn-lg">Submit</button>
            </form>
        </div>
    </div>

    {% endif %}

    {% for category_label, category_items in categorised_items %}
    <div class="category-section mb-4">
        <h2>{{ category_label }}</h2>

        {% for menu_item in category_items %}
        <div class="menu-item row">
            <div class="col-9 col-sm-10">
                <h4>{{ menu_item.name }}</h4>
                <p>{{ menu_item.description }}</p>
                <p>Price: Â£{{ menu_item.price }}</p>
            </div>

            {% if user.is_authenticated and user.is_superuser %}
            <div class="col-3 col-sm-2">
                <div class="row mb-2">
                    <div class="col-12">
                        <a href="#" class="btn btn-warning btn-sm edit-btn">
                            <i class="fas fa-cogs"></i> Edit
                        </a>
                    </div>
                </div>
                <div class="row">
                    <div class="col-12">
                        <a href="#" class="btn btn-danger btn-sm delete-btn">
                            <i class="fas fa-trash-alt"></i> Delete
                        </a>
                    </div>
                </div>
            </div>
            {% endif %}
        </div>
        {% empty %}
        <p>No items available in this category.</p>
        {% endfor %}
    </div>
    {% endfor %}

</div>

{% endblock content %}

{% block extras %}
<script src="{% static 'js/menu.js' %}"></script>
{% endblock %}